% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/HG Functions.R
\name{ExpVarHG.imperfect}
\alias{ExpVarHG.imperfect}
\title{Unified Expectation and Variance Calculation for Imperfect Tests}
\usage{
ExpVarHG.imperfect(N, Tx, barN, b, delta, lambda, type = c("group", "item"))
}
\arguments{
\item{N}{Total number of items.}

\item{Tx}{Number of contaminated items.}

\item{barN}{Number of items per group.}

\item{b}{Number of groups.}

\item{delta}{Sensitivity of the test.}

\item{lambda}{Specificity of the test.}

\item{type}{Character string specifying whether to use "group" or "item" calculations.
Default is \code{"group"}.}
}
\value{
A list with the following elements:
\describe{
\item{V}{Probability that a single group tests positive.}
\item{W}{Covariance between two groups.}
\item{expectation}{Expected number of positive groups.}
\item{variance}{Variance of the number of positive groups.}
}
}
\description{
Computes the expectation and variance of positive test groups based on
either group-level or item-level sensitivity and specificity.
}
